const API_BASE = import.meta.env.VITE_API_URL || '/api';

async function request(path, options = {}) {
  const url = API_BASE + path;
  const headers = { 'Content-Type': 'application/json', ...options.headers };

  if (options.token) {
    headers['Authorization'] = 'Bearer ' + options.token;
    delete options.token;
  }

  const res = await fetch(url, { ...options, headers });
  const data = await res.json();

  if (!res.ok) {
    const err = new Error(data.error || `Request failed (${res.status})`);
    err.status = res.status;
    throw err;
  }

  return data;
}

export const authApi = {
  register: (username, password) =>
    request('/auth/register', {
      method: 'POST',
      body: JSON.stringify({ username, password }),
    }),

  login: (username, password) =>
    request('/auth/login', {
      method: 'POST',
      body: JSON.stringify({ username, password }),
    }),

  me: (token) =>
    request('/auth/me', { token }),
};

export const scoresApi = {
  submit: (token, { score, lines_cleared, level, duration_seconds }) =>
    request('/scores', {
      method: 'POST',
      token,
      body: JSON.stringify({ score, lines_cleared, level, duration_seconds }),
    }),

  myScores: (token) =>
    request('/scores/me', { token }),
};

export const leaderboardApi = {
  get: (period = 'alltime') =>
    request('/leaderboard?period=' + period),
};
